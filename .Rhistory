group_by(state, date) %>%
summarize(new_death = sum(new_death),
new_case = sum(new_case))
covid_week$state <- state.name[match(covid_week$state, state.abb)]
dat_2 <- covid_week %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
full_join(polls, by = c("state", "date")) %>%
select(-answer) %>%
mutate(state_poll_chng = avg_poll - lag(avg_poll, order_by = date)) %>%
mutate(nat_poll_chng = nat_poll - lag(nat_poll, order_by = date)) %>%
mutate(poll_chng = state_poll_chng - nat_poll_chng)
death_trends <- dat_2 %>%
ggplot(aes(log(new_death), poll_chng)) +
geom_point() +
facet_wrap(~ state) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
labs(y = "Weekly Change in Polls",
x = "Weekly New Covid Deaths")
death_trends
?floor_Date
?floor_date
polls <- polls_2020 %>%
select(poll_id, state, answer, end_date, pct) %>%
mutate(end_date = mdy(polls_2020$end_date)) %>%
filter(end_date > ymd("2020-08-01") & end_date < ymd("2020-10-17")) %>%
filter(answer == "Biden" | answer == "Trump") %>%
mutate(date = floor_date(end_date, "day")) %>%
group_by(answer, date) %>%
mutate(nat_poll = mean(pct)) %>%
ungroup() %>%
group_by(state, answer, date) %>%
mutate(avg_poll = mean(pct)) %>%
filter(answer == "Trump") %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
select(state, answer, date, nat_poll, avg_poll) %>%
unique()
covid_week <- covid %>%
select(submission_date, state, new_death, new_case) %>%
mutate(submission_date = mdy(submission_date)) %>%
filter(submission_date > ymd("2020-08-01") & submission_date < ymd("2020-10-17")) %>%
mutate(date = floor_date(submission_date, "day")) %>%
group_by(state, date) %>%
summarize(new_death = sum(new_death),
new_case = sum(new_case))
covid_week$state <- state.name[match(covid_week$state, state.abb)]
dat_2 <- covid_week %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
full_join(polls, by = c("state", "date")) %>%
select(-answer) %>%
mutate(state_poll_chng = avg_poll - lag(avg_poll, order_by = date)) %>%
mutate(nat_poll_chng = nat_poll - lag(nat_poll, order_by = date)) %>%
mutate(poll_chng = state_poll_chng - nat_poll_chng)
death_trends <- dat_2 %>%
ggplot(aes(log(new_death), poll_chng)) +
geom_point() +
facet_wrap(~ state) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
labs(y = "Weekly Change in Polls",
x = "Weekly New Covid Deaths")
death_trends
death_trends <- dat_2 %>%
ggplot(aes(new_death, poll_chng)) +
geom_point() +
facet_wrap(~ state) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
labs(y = "Weekly Change in Polls",
x = "Weekly New Covid Deaths")
death_trends
polls <- polls_2020 %>%
select(poll_id, state, answer, end_date, pct) %>%
mutate(end_date = mdy(polls_2020$end_date)) %>%
filter(end_date > ymd("2020-08-01") & end_date < ymd("2020-10-17")) %>%
filter(answer == "Biden" | answer == "Trump") %>%
mutate(date = floor_date(end_date, "day")) %>%
group_by(answer, date) %>%
mutate(nat_poll = mean(pct)) %>%
ungroup() %>%
group_by(state, answer, date) %>%
mutate(avg_poll = mean(pct)) %>%
filter(answer == "Trump") %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
select(state, answer, date, nat_poll, avg_poll) %>%
unique()
covid_week <- covid %>%
select(submission_date, state, new_death, new_case) %>%
mutate(submission_date = mdy(submission_date)) %>%
filter(submission_date > ymd("2020-08-01") & submission_date < ymd("2020-10-17")) %>%
mutate(date = floor_date(submission_date, "day")) %>%
group_by(state, date) %>%
summarize(new_death = sum(new_death),
new_case = sum(new_case))
covid_week$state <- state.name[match(covid_week$state, state.abb)]
dat_2 <- covid_week %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
inner_join(polls, by = c("state", "date")) %>%
select(-answer) %>%
mutate(state_poll_chng = avg_poll - lag(avg_poll, order_by = date)) %>%
mutate(nat_poll_chng = nat_poll - lag(nat_poll, order_by = date)) %>%
mutate(poll_chng = state_poll_chng - nat_poll_chng)
death_trends <- dat_2 %>%
ggplot(aes(log(new_death), poll_chng)) +
geom_point() +
facet_wrap(~ state) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
labs(y = "Weekly Change in Polls",
x = "Weekly New Covid Deaths")
death_trends
polls <- polls_2020 %>%
select(poll_id, state, answer, end_date, pct) %>%
mutate(end_date = mdy(polls_2020$end_date)) %>%
filter(end_date > ymd("2020-08-01") & end_date < ymd("2020-10-17")) %>%
filter(answer == "Biden" | answer == "Trump") %>%
mutate(date = floor_date(end_date, "2 days")) %>%
group_by(answer, date) %>%
mutate(nat_poll = mean(pct)) %>%
ungroup() %>%
group_by(state, answer, date) %>%
mutate(avg_poll = mean(pct)) %>%
filter(answer == "Trump") %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
select(state, answer, date, nat_poll, avg_poll) %>%
unique()
covid_week <- covid %>%
select(submission_date, state, new_death, new_case) %>%
mutate(submission_date = mdy(submission_date)) %>%
filter(submission_date > ymd("2020-08-01") & submission_date < ymd("2020-10-17")) %>%
mutate(date = floor_date(submission_date, "2 days")) %>%
group_by(state, date) %>%
summarize(new_death = sum(new_death),
new_case = sum(new_case))
covid_week$state <- state.name[match(covid_week$state, state.abb)]
dat_2 <- covid_week %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
full_join(polls, by = c("state", "date")) %>%
select(-answer) %>%
mutate(state_poll_chng = avg_poll - lag(avg_poll, order_by = date)) %>%
mutate(nat_poll_chng = nat_poll - lag(nat_poll, order_by = date)) %>%
mutate(poll_chng = state_poll_chng - nat_poll_chng)
death_trends <- dat_2 %>%
ggplot(aes(log(new_death), poll_chng)) +
geom_point() +
facet_wrap(~ state) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
labs(y = "Weekly Change in Polls",
x = "Weekly New Covid Deaths")
death_trends
polls <- polls_2020 %>%
select(poll_id, state, answer, end_date, pct) %>%
mutate(end_date = mdy(polls_2020$end_date)) %>%
filter(end_date > ymd("2020-08-01") & end_date < ymd("2020-10-17")) %>%
filter(answer == "Biden" | answer == "Trump") %>%
mutate(date = floor_date(end_date, "3 days")) %>%
group_by(answer, date) %>%
mutate(nat_poll = mean(pct)) %>%
ungroup() %>%
group_by(state, answer, date) %>%
mutate(avg_poll = mean(pct)) %>%
filter(answer == "Trump") %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
select(state, answer, date, nat_poll, avg_poll) %>%
unique()
covid_week <- covid %>%
select(submission_date, state, new_death, new_case) %>%
mutate(submission_date = mdy(submission_date)) %>%
filter(submission_date > ymd("2020-08-01") & submission_date < ymd("2020-10-17")) %>%
mutate(date = floor_date(submission_date, "3 days")) %>%
group_by(state, date) %>%
summarize(new_death = sum(new_death),
new_case = sum(new_case))
covid_week$state <- state.name[match(covid_week$state, state.abb)]
dat_2 <- covid_week %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
full_join(polls, by = c("state", "date")) %>%
select(-answer) %>%
mutate(state_poll_chng = avg_poll - lag(avg_poll, order_by = date)) %>%
mutate(nat_poll_chng = nat_poll - lag(nat_poll, order_by = date)) %>%
mutate(poll_chng = state_poll_chng - nat_poll_chng)
death_trends <- dat_2 %>%
ggplot(aes(log(new_death), poll_chng)) +
geom_point() +
facet_wrap(~ state) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
labs(y = "Weekly Change in Polls",
x = "Weekly New Covid Deaths")
death_trends
polls <- polls_2020 %>%
select(poll_id, state, answer, end_date, pct) %>%
mutate(end_date = mdy(polls_2020$end_date)) %>%
filter(end_date > ymd("2020-08-01") & end_date < ymd("2020-10-17")) %>%
filter(answer == "Biden" | answer == "Trump") %>%
mutate(date = floor_date(end_date, "4 days")) %>%
group_by(answer, date) %>%
mutate(nat_poll = mean(pct)) %>%
ungroup() %>%
group_by(state, answer, date) %>%
mutate(avg_poll = mean(pct)) %>%
filter(answer == "Trump") %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
select(state, answer, date, nat_poll, avg_poll) %>%
unique()
covid_week <- covid %>%
select(submission_date, state, new_death, new_case) %>%
mutate(submission_date = mdy(submission_date)) %>%
filter(submission_date > ymd("2020-08-01") & submission_date < ymd("2020-10-17")) %>%
mutate(date = floor_date(submission_date, "4 days")) %>%
group_by(state, date) %>%
summarize(new_death = sum(new_death),
new_case = sum(new_case))
covid_week$state <- state.name[match(covid_week$state, state.abb)]
dat_2 <- covid_week %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
full_join(polls, by = c("state", "date")) %>%
select(-answer) %>%
mutate(state_poll_chng = avg_poll - lag(avg_poll, order_by = date)) %>%
mutate(nat_poll_chng = nat_poll - lag(nat_poll, order_by = date)) %>%
mutate(poll_chng = state_poll_chng - nat_poll_chng)
death_trends <- dat_2 %>%
ggplot(aes(log(new_death), poll_chng)) +
geom_point() +
facet_wrap(~ state) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
labs(y = "Weekly Change in Polls",
x = "Weekly New Covid Deaths")
death_trends
polls <- polls_2020 %>%
select(poll_id, state, answer, end_date, pct) %>%
mutate(end_date = mdy(polls_2020$end_date)) %>%
filter(end_date > ymd("2020-08-01") & end_date < ymd("2020-10-17")) %>%
filter(answer == "Biden" | answer == "Trump") %>%
mutate(date = floor_date(end_date, "5 days")) %>%
group_by(answer, date) %>%
mutate(nat_poll = mean(pct)) %>%
ungroup() %>%
group_by(state, answer, date) %>%
mutate(avg_poll = mean(pct)) %>%
filter(answer == "Trump") %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
select(state, answer, date, nat_poll, avg_poll) %>%
unique()
covid_week <- covid %>%
select(submission_date, state, new_death, new_case) %>%
mutate(submission_date = mdy(submission_date)) %>%
filter(submission_date > ymd("2020-08-01") & submission_date < ymd("2020-10-17")) %>%
mutate(date = floor_date(submission_date, "5 days")) %>%
group_by(state, date) %>%
summarize(new_death = sum(new_death),
new_case = sum(new_case))
covid_week$state <- state.name[match(covid_week$state, state.abb)]
dat_2 <- covid_week %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
full_join(polls, by = c("state", "date")) %>%
select(-answer) %>%
mutate(state_poll_chng = avg_poll - lag(avg_poll, order_by = date)) %>%
mutate(nat_poll_chng = nat_poll - lag(nat_poll, order_by = date)) %>%
mutate(poll_chng = state_poll_chng - nat_poll_chng)
death_trends <- dat_2 %>%
ggplot(aes(log(new_death), poll_chng)) +
geom_point() +
facet_wrap(~ state) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
labs(y = "Weekly Change in Polls",
x = "Weekly New Covid Deaths")
death_trends
polls <- polls_2020 %>%
select(poll_id, state, answer, end_date, pct) %>%
mutate(end_date = mdy(polls_2020$end_date)) %>%
filter(end_date > ymd("2020-08-01") & end_date < ymd("2020-10-17")) %>%
filter(answer == "Biden" | answer == "Trump") %>%
mutate(date = floor_date(end_date, "1 week")) %>%
group_by(answer, date) %>%
mutate(nat_poll = mean(pct)) %>%
ungroup() %>%
group_by(state, answer, date) %>%
mutate(avg_poll = mean(pct)) %>%
filter(answer == "Trump") %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
select(state, answer, date, nat_poll, avg_poll) %>%
unique()
covid_week <- covid %>%
select(submission_date, state, new_death, new_case) %>%
mutate(submission_date = mdy(submission_date)) %>%
filter(submission_date > ymd("2020-08-01") & submission_date < ymd("2020-10-17")) %>%
mutate(date = floor_date(submission_date, "1 week")) %>%
group_by(state, date) %>%
summarize(new_death = sum(new_death),
new_case = sum(new_case))
covid_week$state <- state.name[match(covid_week$state, state.abb)]
dat_2 <- covid_week %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
full_join(polls, by = c("state", "date")) %>%
select(-answer) %>%
mutate(state_poll_chng = avg_poll - lag(avg_poll, order_by = date)) %>%
mutate(nat_poll_chng = nat_poll - lag(nat_poll, order_by = date)) %>%
mutate(poll_chng = state_poll_chng - nat_poll_chng)
death_trends <- dat_2 %>%
ggplot(aes(log(new_death), poll_chng)) +
geom_point() +
facet_wrap(~ state) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
labs(y = "Weekly Change in Polls",
x = "Weekly New Covid Deaths")
death_trends
polls <- polls_2020 %>%
select(poll_id, state, answer, end_date, pct) %>%
mutate(end_date = mdy(polls_2020$end_date)) %>%
filter(end_date > ymd("2020-08-01") & end_date < ymd("2020-10-17")) %>%
filter(answer == "Biden" | answer == "Trump") %>%
mutate(date = floor_date(end_date, "2 week")) %>%
group_by(answer, date) %>%
mutate(nat_poll = mean(pct)) %>%
ungroup() %>%
group_by(state, answer, date) %>%
mutate(avg_poll = mean(pct)) %>%
filter(answer == "Trump") %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
select(state, answer, date, nat_poll, avg_poll) %>%
unique()
covid_week <- covid %>%
select(submission_date, state, new_death, new_case) %>%
mutate(submission_date = mdy(submission_date)) %>%
filter(submission_date > ymd("2020-08-01") & submission_date < ymd("2020-10-17")) %>%
mutate(date = floor_date(submission_date, "2 week")) %>%
group_by(state, date) %>%
summarize(new_death = sum(new_death),
new_case = sum(new_case))
polls <- polls_2020 %>%
select(poll_id, state, answer, end_date, pct) %>%
mutate(end_date = mdy(polls_2020$end_date)) %>%
filter(end_date > ymd("2020-08-01") & end_date < ymd("2020-10-17")) %>%
filter(answer == "Biden" | answer == "Trump") %>%
mutate(date = floor_date(end_date, "6 days")) %>%
group_by(answer, date) %>%
mutate(nat_poll = mean(pct)) %>%
ungroup() %>%
group_by(state, answer, date) %>%
mutate(avg_poll = mean(pct)) %>%
filter(answer == "Trump") %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
select(state, answer, date, nat_poll, avg_poll) %>%
unique()
covid_week <- covid %>%
select(submission_date, state, new_death, new_case) %>%
mutate(submission_date = mdy(submission_date)) %>%
filter(submission_date > ymd("2020-08-01") & submission_date < ymd("2020-10-17")) %>%
mutate(date = floor_date(submission_date, "6 days")) %>%
group_by(state, date) %>%
summarize(new_death = sum(new_death),
new_case = sum(new_case))
covid_week$state <- state.name[match(covid_week$state, state.abb)]
dat_2 <- covid_week %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
full_join(polls, by = c("state", "date")) %>%
select(-answer) %>%
mutate(state_poll_chng = avg_poll - lag(avg_poll, order_by = date)) %>%
mutate(nat_poll_chng = nat_poll - lag(nat_poll, order_by = date)) %>%
mutate(poll_chng = state_poll_chng - nat_poll_chng)
death_trends <- dat_2 %>%
ggplot(aes(log(new_death), poll_chng)) +
geom_point() +
facet_wrap(~ state) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
labs(y = "Weekly Change in Polls",
x = "Weekly New Covid Deaths")
death_trends
polls <- polls_2020 %>%
select(poll_id, state, answer, end_date, pct) %>%
mutate(end_date = mdy(polls_2020$end_date)) %>%
filter(end_date > ymd("2020-08-01") & end_date < ymd("2020-10-17")) %>%
filter(answer == "Biden" | answer == "Trump") %>%
mutate(date = floor_date(end_date, "1 week")) %>%
group_by(answer, date) %>%
mutate(nat_poll = mean(pct)) %>%
ungroup() %>%
group_by(state, answer, date) %>%
mutate(avg_poll = mean(pct)) %>%
filter(answer == "Trump") %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
select(state, answer, date, nat_poll, avg_poll) %>%
unique()
covid_week <- covid %>%
select(submission_date, state, new_death, new_case) %>%
mutate(submission_date = mdy(submission_date)) %>%
filter(submission_date > ymd("2020-08-01") & submission_date < ymd("2020-10-17")) %>%
mutate(date = floor_date(submission_date, "1 week")) %>%
group_by(state, date) %>%
summarize(new_death = sum(new_death),
new_case = sum(new_case))
covid_week$state <- state.name[match(covid_week$state, state.abb)]
dat_2 <- covid_week %>%
filter(state %in% c("Florida", "Wisconsin", "Pennsylvania", "Georgia", "North Carolina",
"Arizona", "Michigan", "Ohio", "New Hampshire")) %>%
full_join(polls, by = c("state", "date")) %>%
select(-answer) %>%
mutate(state_poll_chng = avg_poll - lag(avg_poll, order_by = date)) %>%
mutate(nat_poll_chng = nat_poll - lag(nat_poll, order_by = date)) %>%
mutate(poll_chng = state_poll_chng - nat_poll_chng)
death_trends <- dat_2 %>%
ggplot(aes(log(new_death), poll_chng)) +
geom_point() +
facet_wrap(~ state) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
labs(y = "Weekly Change in Polls",
x = "Weekly New Covid Deaths")
case_trends <- dat_2 %>%
ggplot(aes(log(new_case), poll_chng)) +
geom_point() +
facet_wrap(~ state) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
labs(y = "Weekly Change in Polls",
x = "Weekly New Covid Cases")
covid_trends <- case_trends + death_trends
ggsave(path = "images", filename = "covid_polls.png", height = 6, width = 10)
death_trends
covid_trends <- case_trends / death_trends
ggsave(path = "images", filename = "covid_polls.png", height = 6, width = 10)
covid_trends
covid_trends <- case_trends / death_trends
ggsave(path = "images", filename = "covid_polls.png", height = 10, width = 10)
battleground_covid_graph <- battleground_covid_cases + battleground_covid
ggsave(path = "images", filename = "battleground_covid.png", height = 6, width = 10)
battleground_covid <- dat %>%
ggplot(aes(x = reorder(state, -avg_per_cap_deaths), y = avg_per_cap_deaths)) +
geom_bar(stat = "identity", fill = "steelblue2") +
labs(title = "Recent COVID-19 Deaths in Battleground States",
x = "",
y = "Deaths per 100,000 Since August") +
theme_clean() +
geom_hline(yintercept = dat$average_deaths, lwd = 2, lty = 2, col = "indianred") +
element_text(angle = 45)
battleground_covid <- dat %>%
ggplot(aes(x = reorder(state, -avg_per_cap_deaths), y = avg_per_cap_deaths)) +
geom_bar(stat = "identity", fill = "steelblue2") +
labs(title = "Recent COVID-19 Deaths in Battleground States",
x = "",
y = "Deaths per 100,000 Since August") +
theme_clean() +
geom_hline(yintercept = dat$average_deaths, lwd = 2, lty = 2, col = "indianred") +
theme(axis.text.x = element_text(angle = 45))
battleground_covid
battleground_covid <- dat %>%
ggplot(aes(x = reorder(state, -avg_per_cap_deaths), y = avg_per_cap_deaths)) +
geom_bar(stat = "identity", fill = "steelblue2") +
labs(title = "Recent COVID-19 Deaths in Battleground States",
x = "",
y = "Deaths per 100,000 Since August") +
theme_clean() +
geom_hline(yintercept = dat$average_deaths, lwd = 2, lty = 2, col = "indianred") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
battleground_covid
battleground_covid_cases <- dat %>%
ggplot(aes(x = reorder(state, -avg_per_cap_cases), y = avg_per_cap_cases)) +
geom_bar(stat = "identity", fill = "steelblue2") +
labs(title = "Recent COVID-19 Cases in Battleground States",
x = "",
y = "Cases per 100,000 Since August") +
theme_clean() +
geom_hline(yintercept = dat$average_cases, lwd = 2, lty = 2, col = "indianred") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
battleground_covid_graph <- battleground_covid_cases + battleground_covid
battleground_covid_graph
battleground_covid <- dat %>%
ggplot(aes(x = reorder(state, -avg_per_cap_deaths), y = avg_per_cap_deaths)) +
geom_bar(stat = "identity", fill = "steelblue2") +
labs(title = "Battleground COVID-19 Deaths",
x = "",
y = "Deaths per 100,000 Since August") +
theme_clean() +
geom_hline(yintercept = dat$average_deaths, lwd = 2, lty = 2, col = "indianred") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
battleground_covid_cases <- dat %>%
ggplot(aes(x = reorder(state, -avg_per_cap_cases), y = avg_per_cap_cases)) +
geom_bar(stat = "identity", fill = "steelblue2") +
labs(title = "Battleground COVID-19 Cases",
x = "",
y = "Cases per 100,000 Since August") +
theme_clean() +
geom_hline(yintercept = dat$average_cases, lwd = 2, lty = 2, col = "indianred") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
battleground_covid_graph <- battleground_covid_cases + battleground_covid
ggsave(path = "images", filename = "battleground_covid.png", height = 6, width = 10)
battleground_covid_graph
